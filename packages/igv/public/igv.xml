<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE visualization SYSTEM "../../visualization.dtd">
<visualization name="Integrative Genomics Viewer" embeddable="true">
    <description>Explore Genomic Data</description>
    <data_sources>
        <data_source>
            <model_class>HistoryDatasetAssociation</model_class>
            <test test_attr="ext">bam</test>
            <test test_attr="ext">bcf</test>
            <test test_attr="ext">bed</test>
            <test test_attr="ext">bedgraph</test>
            <test test_attr="ext">bigbed</test>
            <test test_attr="ext">bigwig</test>
            <test test_attr="ext">cram</test>
            <test test_attr="ext">fasta</test>
            <test test_attr="ext">gff</test>
            <test test_attr="ext">gff3</test>
            <test test_attr="ext">gtf</test>
            <test test_attr="ext">twobit</test>
            <test test_attr="ext">vcf</test>
            <test test_attr="ext">vcf_bgzip</test>
            <test test_attr="ext">wig</test>
        </data_source>
    </data_sources>
    <params>
        <param required="true">dataset_id</param>
    </params>
    <entry_point entry_point_type="script" src="index.js" css="index.css" />
    <settings>
        <input>
            <label>Locus</label>
            <help>Select a gene locus e.g. chr1:1-100.</help>
            <name>locus</name>
            <type>text</type>
            <deferred>true</deferred>
            <value>all</value>
        </input>
        <input>
            <label>Source</label>
            <help>Pick a genome source.</help>
            <name>source</name>
            <type>conditional</type>
            <test_param>
                <name>origin</name>
                <type>select</type>
                <value>igv</value>
                <data>
                    <data>
                        <label>IGV Remote Genome</label>
                        <value>igv</value>
                    </data>
                    <data>
                        <label>Galaxy Reference Genome</label>
                        <value>builtin</value>
                    </data>
                </data>
            </test_param>
            <cases>
                <cases>
                    <value>builtin</value>
                    <inputs>
                        <inputs>
                            <label>Genome</label>
                            <help>Select a reference genome.</help>
                            <name>genome</name>
                            <type>data_table</type>
                            <tables>
                                <tables>fasta_indexes</tables>
                                <tables>twobit</tables>
                            </tables>
                        </inputs>
                    </inputs>
                </cases>
                <cases>
                    <value>igv</value>
                    <inputs>
                        <inputs>
                            <label>Genome</label>
                            <help>Select a reference genome from IGV.</help>
                            <name>genome</name>
                            <type>data_json</type>
                            <url>https://s3.amazonaws.com/igv.org.genomes/genomes.json</url>
                        </inputs>
                    </inputs>
                </cases>
            </cases>
        </input>
    </settings>
    <tracks>
        <input>
            <label>Name</label>
            <help>Specify a track name.</help>
            <name>name</name>
            <type>text</type>
            <value>Track</value>
        </input>
        <input>
            <label>Dataset</label>
            <help>Select a track dataset.</help>
            <name>urlDataset</name>
            <type>data</type>
        </input>
        <input>
            <label>Index</label>
            <help>Select an index (or auto-detect from dataset metadata).</help>
            <name>indexUrlDataset</name>
            <type>data</type>
            <optional>true</optional>
        </input>
        <input>
            <label>Type</label>
            <help>Select the track type (or auto-detect from dataset format).</help>
            <name>type</name>
            <type>select</type>
            <value>auto</value>
            <data>
                <data><label>Auto</label><value>auto</value></data>
                <data><label>Annotation</label><value>annotation</value></data>
                <data><label>Copy Number Variation (CNV)</label><value>cnv</value></data>
                <data><label>SNP</label><value>snp</value></data>
                <data><label>GA4GH</label><value>ga4gh</value></data>
            </data>
        </input>
        <input>
            <label>Mode</label>
            <help>Select a display mode.</help>
            <name>displayMode</name>
            <type>select</type>
            <value>EXPANDED</value>
            <data>
                <data><label>Collapsed</label><value>COLLAPSED</value></data>
                <data><label>Squished</label><value>SQUISHED</value></data>
                <data><label>Expanded</label><value>EXPANDED</value></data>
            </data>
        </input>
        <input>
            <label>Color</label>
            <help>Pick a color.</help>
            <name>color</name>
            <type>color</type>
        </input>
    </tracks>
    <tests>
        <test>
            <param name="dataset_id" value="http://cdn.jsdelivr.net/gh/galaxyproject/galaxy-test-data/gencode.v29.annotation.bed" ftype="bed" />
        </test>
        <test>
            <param name="dataset_id" value="http://cdn.jsdelivr.net/gh/galaxyproject/galaxy-test-data/gencode.v29.annotation.gff3" ftype="gff3" />
        </test>
    </tests>
    <help format="markdown"><![CDATA[
# What is IGV?

The Integrative Genomics Viewer (IGV) is a high-performance, interactive browser for exploring large genomic datasets. This tool integrates seamlessly with Galaxy to provide fast, scalable visualization of sequencing data and annotations directly in the browser.

## Key Features

- **Multi-format Support**: View alignments, variants, annotations, and coverage from BAM, CRAM, VCF, GFF/GTF, BED, BigWig, BigBed, and more.
- **Reference Genomes**: Load locally indexed FASTA/2bit references or select from IGVâ€™s extensive genome collection.
- **Interactive Navigation**: Jump to specific chromosomes, loci, or genes; zoom across whole chromosomes or individual bases.
- **Track Management**: Add multiple datasets as tracks, configure colors, display modes, and track types.
- **Scalability**: Optimized for very large datasets with smooth, real-time panning and zooming.
- **Custom Views**: Adjust track layouts, collapse or expand features, and highlight regions of interest.

Learn more at: [https://igv.org](https://igv.org)
    ]]></help>
</visualization>